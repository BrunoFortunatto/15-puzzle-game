<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15 Puzzle Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
            padding-top: 30px;
            box-sizing: border-box;
            margin: 0;
        }

        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }

        body.dark-mode .title {
            color: #ffffff;
        }

        body.dark-mode .btn {
            background-color: #333333;
            color: #ffffff;
        }

        body.dark-mode .btn:hover {
            background-color: #555555;
        }

        body.dark-mode .game-container {
            background-color: #121212;
            /* Fundo s√≥lido para o container do jogo */
            border-radius: 10px;
            /* Opcional: bordas arredondadas */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            /* Sombra para destaque */
        }

        body.dark-mode .tile {
            background-color: #333333;
            color: #ffffff;
        }

        body.dark-mode .tile.correct-position {
            background-color: #444444;
            color: #ffffff;
        }

        body.dark-mode .empty {
            background-color: #1e1e1e;
        }

        body.dark-mode .win-message {
            background-color: #333333;
            color: #ffffff;
        }

        body.dark-mode .developer-info {
            background-color: rgba(255, 255, 255, 0.8);
            color: #000000;
        }

        body.dark-mode .scoreboard-container {
            background-color: #1e1e1e;
            /* Fundo escuro para o painel */
            color: #ffffff;
            /* Texto claro */
            border-radius: 10px;
            /* Bordas arredondadas */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            /* Sombra para destaque */
        }

        body.dark-mode .scoreboard-column h3 {
            color: #ffffff;
        }

        body.dark-mode .scoreboard-column div {
            color: #cccccc;
        }

        body.dark-mode .scoreboard-column strong {
            color: #ffcc00;
            /* Destaque para os melhores resultados */
        }

        body.dark-mode .scoreboard-columns {
            background-color: #2a2a2a;
            /* Fundo escuro para as colunas */
            color: #ffffff;
            /* Texto claro */
            border-radius: 10px;
            /* Bordas arredondadas */
            padding: 10px;
            /* Espa√ßamento interno */
        }

        body.dark-mode .scoreboard-column {
            background-color: #333333;
            /* Fundo individual das colunas */
            color: #ffffff;
            /* Texto claro */
            border-radius: 5px;
            /* Bordas arredondadas */
            padding: 10px;
            /* Espa√ßamento interno */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            /* Sombra para destaque */
        }

        body.dark-mode .board {
            background-color: #1e1e1e;
            /* Fundo s√≥lido para o tabuleiro */
            border-radius: 10px;
            /* Opcional: bordas arredondadas */
        }

        .title {
            font-family: 'Press Start 2P', cursive;
            font-size: 24px;
            color: #002147;
            margin-bottom: 15px;
            text-align: center;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            /* Permite que os bot√µes quebrem linha em telas menores */
            justify-content: center;
            gap: 10px;
            /* Espa√ßamento consistente entre os bot√µes */
            margin-bottom: 20px;
        }

        .btn {
            background-color: #002147;
            color: #fff;
            font-size: 16px;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            min-width: 110px;
            /* Largura m√≠nima original */
            width: auto;
            /* Garante que a largura se ajuste ao conte√∫do, mas n√£o menos que min-width */
        }

        .btn:hover {
            background-color: #004080;
        }

        .status-container {
            display: flex;
            gap: 20px;
            /* Espa√ßamento entre os √≠cones */
            align-items: center;
            /* Centraliza os itens verticalmente */
            justify-content: center;
            /* Centraliza o conte√∫do */
            background-color: rgba(255, 255, 255, 0.8);
            /* Fundo claro */
            border-radius: 5px;
            /* Bordas arredondadas */
            padding: 5px 10px;
            /* Espa√ßamento interno */
            min-width: 200px;
            /* Garante espa√ßo suficiente para os elementos */
        }

        .status-container .icon {
            color: #000;
            /* Cor do texto para contraste com o fundo claro */
        }

        .icon {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .icon-btn.theme-arrow {
            width: 40px;
            /* Define uma largura fixa */
            height: 40px;
            /* Define uma altura fixa igual √† largura */
            border-radius: 50%;
            /* Torna o bot√£o circular */
            display: flex;
            /* Garante alinhamento do conte√∫do */
            justify-content: center;
            /* Centraliza horizontalmente */
            align-items: center;
            /* Centraliza verticalmente */
            padding: 0;
            /* Remove qualquer espa√ßamento interno */
            box-sizing: border-box;
            /* Inclui bordas e preenchimento no tamanho total */
        }

        #moveCounter,
        #timer {
            min-width: 80px;
            /* Define uma largura m√≠nima suficiente */
            text-align: center;
            /* Centraliza o texto */
            display: inline-block;
            /* Garante que o elemento respeite a largura m√≠nima */
            font-size: 18px;
            /* Tamanho da fonte */
            font-weight: bold;
            /* Deixa o texto em negrito */
        }

        .main-container {
            display: flex;
            flex-direction: column;
            /* Organiza os elementos verticalmente */
            align-items: center;
            justify-content: center;
            gap: 20px;
            /* Espa√ßamento entre os elementos */
            margin-top: 20px;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            /* Alinha os elementos verticalmente */
            align-items: center;
            /* Centraliza os elementos horizontalmente */
            justify-content: center;
            /* Centraliza os elementos verticalmente */
            width: 100%;
            max-width: 520px;
            /* Limita a largura m√°xima */
            margin: 0 auto;
            /* Centraliza o cont√™iner na p√°gina */
            box-sizing: border-box;
        }

        .board-options {
            display: flex;
            justify-content: space-evenly;
            /* Distribui os √≠cones uniformemente */
            align-items: center;
            /* Centraliza os √≠cones verticalmente */
            gap: 15px;
            /* Espa√ßamento uniforme entre os √≠cones */
            padding: 10px;
            background-color: inherit;
            border-radius: 10px 10px 0 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
            width: 100%;
            /* Garante que ocupe toda a largura dispon√≠vel */
        }

        .board {
            display: grid;
            gap: 5px;
            background-color: #002147;
            padding: 20px;
            border-radius: 10px;
            width: 400px;
            /* Reduz a largura */
            height: 400px;
            /* Reduz a altura */
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            box-sizing: border-box;
        }

        .tile {
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            /* Aumentei o tamanho da fonte */
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.15s ease-in-out;
        }

        .tile:hover {
            filter: brightness(90%);
            cursor: pointer;
        }

        .empty {
            background-color: #002147;
            color: transparent;
            cursor: default;
        }

        .paused {
            pointer-events: none;
        }

        .win-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0s linear 0.3s;
        }

        .win-message {
            background-color: #fff;
            color: #002147;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-50px);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        .win-overlay.active {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }

        .win-overlay.active .win-message {
            transform: translateY(0);
            opacity: 1;
            transition-delay: 0.2s;
        }

        .win-message h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 24px;
            margin-bottom: 12px;
        }

        .win-message p {
            margin-bottom: 20px;
            /* Espa√ßamento entre o texto e os bot√µes */
        }

        .play-again-btn {
            background-color: #004080;
            color: #fff;
            font-size: 16px;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }

        .play-again-btn:hover {
            background-color: #0059b3;
        }

        .tile.correct-position {
            background-color: gold;
            color: black;
        }

        .scoreboard-container {
            text-align: center;
            width: 600px;
            margin-left: 50px;
            /* Adicionado margin-left para mover para a direita */
        }

        .scoreboard-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            /* Cria 3 colunas de largura igual */
            gap: 10px;
            /* Espa√ßamento entre as colunas */
            background-color: #ddd;
            padding: 20px;
            /* Espa√ßamento interno geral */
            border-radius: 10px;
            align-items: start;
            /* Alinha os itens no topo das c√©lulas da grade */
        }

        .scoreboard-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Centraliza os itens horizontalmente */
            text-align: center;
            /* Centraliza o texto dentro da coluna */
        }

        .scoreboard-column h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }

        .scoreboard-column div {
            font-size: 14px;
            color: #555;
            margin-bottom: 5px;
            /* Espa√ßamento entre os divs (movimentos e tempos) */
        }

        .scoreboard-column strong {
            font-weight: bold;
            color: #004080;
        }

        .developer-info {
            background-color: rgba(0, 33, 71, 0.8);
            font-size: 14px;
            position: absolute;
            color: #fff;
            top: 10px;
            right: 10px;
            font-family: 'Arial', sans-serif;
            padding: 8px 12px;
            border-radius: 5px;
            z-index: 1000;
            opacity: 0.8;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #002147;
            color: #fff;
            font-size: 14px;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle-btn:hover {
            background-color: #004080;
        }

        /* Tema 1: Azul */
        body.theme-blue .board {
            background-color: #002147;
        }

        body.theme-blue .tile {
            background-color: #ffffff;
            /* Fundo branco */
            color: #002147;
            /* Texto azul escuro */
        }

        body.theme-blue .tile.correct-position {
            background-color: #007BFF;
            /* Azul vibrante */
            color: #ffffff;
            /* Texto branco */
        }

        body.theme-blue .tile.empty {
            background-color: #002147;
            /* Cor do tabuleiro azul */
        }

        /* Tema 2: Verde */
        body.theme-green .board {
            background-color: #004d00;
        }

        body.theme-green .tile {
            background-color: #e6ffe6;
            /* Fundo verde claro */
            color: #004d00;
            /* Texto verde escuro */
        }

        body.theme-green .tile.correct-position {
            background-color: #66ff66;
            color: #003300;
        }

        body.theme-green .tile.empty {
            background-color: #004d00;
            /* Cor do tabuleiro verde */
        }

        /* Tema 3: Vermelho */
        body.theme-red .board {
            background-color: #660000;
        }

        body.theme-red .tile {
            background-color: #ffe6e6;
            /* Fundo vermelho claro */
            color: #660000;
            /* Texto vermelho escuro */
        }

        body.theme-red .tile.correct-position {
            background-color: #ff6666;
            color: #330000;
        }

        body.theme-red .tile.empty {
            background-color: #660000;
            /* Cor do tabuleiro vermelho */
        }

        /* Tema 4: Roxo */
        body.theme-purple .board {
            background-color: #4b0082;
        }

        body.theme-purple .tile {
            background-color: #f3e5f5;
            /* Fundo roxo claro */
            color: #4b0082;
            /* Texto roxo escuro */
        }

        body.theme-purple .tile.correct-position {
            background-color: #d1c4e9;
            color: #2e004d;
        }

        body.theme-purple .tile.empty {
            background-color: #4b0082;
            /* Cor do tabuleiro roxo */
        }

        /* Tema 5: Amarelo */
        body.theme-yellow .board {
            background-color: #ffcc00;
        }

        body.theme-yellow .tile {
            background-color: #fff8e1;
            /* Fundo amarelo claro */
            color: #664d00;
            /* Texto amarelo escuro */
            border: 2px solid #664d00;
            /* Borda com a mesma cor do texto */
        }

        body.theme-yellow .tile.correct-position {
            background-color: #ffeb3b;
            color: #664d00;
        }

        body.theme-yellow .tile.empty {
            background-color: #ffcc00;
            /* Cor do tabuleiro amarelo */
            border: none;
            /* Remove a borda do bloco vazio */
        }

        .tile.empty {
            background-color: inherit;
            /* Herda a cor do tabuleiro */
            color: transparent;
            /* Texto invis√≠vel */
            cursor: default;
            /* Remove o cursor de intera√ß√£o */
        }

        /* Tema 1: Azul no modo escuro */
        body.dark-mode.theme-blue .board {
            background-color: #00122b;
            /* Azul escuro */
        }

        body.dark-mode.theme-blue .tile {
            background-color: #002147;
            /* Azul mais claro */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-blue .tile.correct-position {
            background-color: #004080;
            /* Destaque azul escuro */
            color: #ffffff;
        }

        body.dark-mode.theme-blue .tile.empty {
            background-color: #00122b;
            /* Cor do tabuleiro azul escuro */
        }

        /* Tema 2: Verde no modo escuro */
        body.dark-mode.theme-green .board {
            background-color: #002200;
            /* Verde escuro */
        }

        body.dark-mode.theme-green .tile {
            background-color: #004d00;
            /* Verde mais claro */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-green .tile.correct-position {
            background-color: #006600;
            /* Destaque verde escuro */
            color: #ffffff;
        }

        body.dark-mode.theme-green .tile.empty {
            background-color: #002200;
            /* Cor do tabuleiro verde escuro */
        }

        /* Tema 3: Vermelho no modo escuro */
        body.dark-mode.theme-red .board {
            background-color: #330000;
            /* Vermelho escuro */
        }

        body.dark-mode.theme-red .tile {
            background-color: #660000;
            /* Vermelho mais claro */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-red .tile.correct-position {
            background-color: #990000;
            /* Destaque vermelho escuro */
            color: #ffffff;
        }

        body.dark-mode.theme-red .tile.empty {
            background-color: #330000;
            /* Cor do tabuleiro vermelho escuro */
        }

        /* Tema 4: Roxo no modo escuro */
        body.dark-mode.theme-purple .board {
            background-color: #2e004d;
            /* Roxo escuro */
        }

        body.dark-mode.theme-purple .tile {
            background-color: #4b0082;
            /* Roxo mais claro */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-purple .tile.correct-position {
            background-color: #6a0dad;
            /* Destaque roxo escuro */
            color: #ffffff;
        }

        body.dark-mode.theme-purple .tile.empty {
            background-color: #2e004d;
            /* Cor do tabuleiro roxo escuro */
        }

        /* Tema 5: Amarelo no modo escuro */
        body.dark-mode.theme-yellow .board {
            background-color: #664d00;
            /* Amarelo escuro */
        }

        body.dark-mode.theme-yellow .tile {
            background-color: #ffcc00;
            /* Amarelo mais claro */
            color: #000000;
            /* Texto preto */
        }

        body.dark-mode.theme-yellow .tile.correct-position {
            background-color: #ffeb3b;
            /* Destaque amarelo */
            color: #000000;
        }

        body.dark-mode.theme-yellow .tile.empty {
            background-color: #664d00;
            /* Cor do tabuleiro amarelo escuro */
        }

        /* Tema 6: Laranja */
        body.theme-orange .board {
            background-color: #FF8C00;
            /* Laranja escuro */
        }

        body.theme-orange .tile {
            background-color: #FFE4B5;
            /* Laranja claro */
            color: #8B4500;
            /* Texto laranja escuro */
        }

        body.theme-orange .tile.correct-position {
            background-color: #FFA500;
            /* Destaque laranja vibrante */
            color: #ffffff;
            /* Texto branco */
        }

        body.theme-orange .tile.empty {
            background-color: #FF8C00;
            /* Cor do tabuleiro laranja */
        }

        /* Tema 7: Rosa */
        body.theme-pink .board {
            background-color: #FF1493;
            /* Rosa escuro */
        }

        body.theme-pink .tile {
            background-color: #FFC0CB;
            /* Rosa claro */
            color: #8B008B;
            /* Texto rosa escuro */
        }

        body.theme-pink .tile.correct-position {
            background-color: #FF69B4;
            /* Destaque rosa vibrante */
            color: #ffffff;
            /* Texto branco */
        }

        body.theme-pink .tile.empty {
            background-color: #FF1493;
            /* Cor do tabuleiro rosa */
        }

        /* Tema 8: Cinza */
        body.theme-gray .board {
            background-color: #696969;
            /* Cinza escuro */
        }

        body.theme-gray .tile {
            background-color: #D3D3D3;
            /* Cinza claro */
            color: #2F4F4F;
            /* Texto cinza escuro */
        }

        body.theme-gray .tile.correct-position {
            background-color: #A9A9A9;
            /* Destaque cinza m√©dio */
            color: #ffffff;
            /* Texto branco */
        }

        body.theme-gray .tile.empty {
            background-color: #696969;
            /* Cor do tabuleiro cinza */
        }

        /* Tema 6: Laranja no modo escuro */
        body.dark-mode.theme-orange .board {
            background-color: #CC7000;
            /* Laranja escuro */
        }

        body.dark-mode.theme-orange .tile {
            background-color: #FFB347;
            /* Laranja claro */
            color: #4D2600;
            /* Texto laranja escuro */
        }

        body.dark-mode.theme-orange .tile.correct-position {
            background-color: #FF8C00;
            /* Destaque laranja vibrante */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-orange .tile.empty {
            background-color: #CC7000;
            /* Cor do tabuleiro laranja escuro */
        }

        /* Tema 7: Rosa no modo escuro */
        body.dark-mode.theme-pink .board {
            background-color: #8B004B;
            /* Rosa escuro */
        }

        body.dark-mode.theme-pink .tile {
            background-color: #FF99CC;
            /* Rosa claro */
            color: #4B0026;
            /* Texto rosa escuro */
        }

        body.dark-mode.theme-pink .tile.correct-position {
            background-color: #FF66A3;
            /* Destaque rosa vibrante */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-pink .tile.empty {
            background-color: #8B004B;
            /* Cor do tabuleiro rosa escuro */
        }

        /* Tema 8: Cinza no modo escuro */
        body.dark-mode.theme-gray .board {
            background-color: #2F2F2F;
            /* Cinza escuro */
        }

        body.dark-mode.theme-gray .tile {
            background-color: #A9A9A9;
            /* Cinza claro */
            color: #1C1C1C;
            /* Texto cinza escuro */
        }

        body.dark-mode.theme-gray .tile.correct-position {
            background-color: #696969;
            /* Destaque cinza m√©dio */
            color: #ffffff;
            /* Texto branco */
        }

        body.dark-mode.theme-gray .tile.empty {
            background-color: #2F2F2F;
            /* Cor do tabuleiro cinza escuro */
        }

        .theme-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            /* Espa√ßamento entre as setas e o tabuleiro */
            margin-top: 20px;
        }

        .theme-arrow:hover {
            background-color: #004080;
        }

        .left-arrow {
            margin-right: 10px;
        }

        .right-arrow {
            margin-left: 10px;
        }

        .win-message button {
            margin: 0 10px;
            /* Espa√ßamento horizontal entre os bot√µes */
        }

        .win-message .play-again-btn {
            margin: 0 10px;
            /* Espa√ßamento horizontal entre os bot√µes */
        }

        .icon-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            position: relative;
        }

        .icon-btn {
            width: 40px;
            /* Define uma largura fixa */
            height: 40px;
            /* Define uma altura fixa */
            margin: 0;
            /* Remove margens individuais */
            padding: 0;
            /* Remove espa√ßamento interno */
            border: none;
            border-radius: 50%;
            /* Torna o bot√£o circular */
            background-color: rgba(255, 255, 255, 0.8);
            color: #002147;
            font-size: 20px;
            /* Tamanho do √≠cone */
            display: flex;
            /* Garante alinhamento do conte√∫do */
            justify-content: center;
            /* Centraliza horizontalmente */
            align-items: center;
            /* Centraliza verticalmente */
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .icon-btn:hover {
            background-color: rgba(255, 255, 255, 1);
            color: #004080;
        }

        /* Remova margens espec√≠ficas de bot√µes como .restart-btn e .ranking-btn */
        .restart-btn,
        .ranking-btn {
            margin: 0;
            /* Remove margens extras */
        }

        .dropdown {
            position: relative;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            /* Posiciona logo abaixo do bot√£o */
            left: 60%;
            /* Move um pouco mais para a direita */
            transform: translateX(-50%);
            /* Centraliza em rela√ß√£o ao ponto definido por 'left' */
            background-color: #ffffff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 10px;
        }

        .dropdown-menu button {
            background-color: #002147;
            color: #fff;
            font-size: 14px;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 5px;
            width: 100%;
            text-align: left;
        }

        .dropdown-menu button:hover {
            background-color: #004080;
        }

        .upload-btn {
            background-color: rgba(255, 255, 255, 0.8);
            /* Fundo claro */
            color: #002147;
            /* Cor do √≠cone */
            font-size: 20px;
            /* Tamanho do √≠cone */
            padding: 10px;
            border: none;
            border-radius: 50%;
            /* Fundo circular */
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            /* Sombra para destaque */
        }

        .upload-btn:hover {
            background-color: rgba(255, 255, 255, 1);
            /* Fundo mais claro no hover */
            color: #004080;
            /* Cor mais vibrante no hover */
        }

        /* Tema Azul */
        body.theme-blue .board,
        body.theme-blue .board-options,
        body.theme-blue .game-container {
            background-color: #002147;
        }

        /* Tema Verde */
        body.theme-green .board,
        body.theme-green .board-options,
        body.theme-green .game-container {
            background-color: #004d00;
        }

        /* Tema Vermelho */
        body.theme-red .board,
        body.theme-red .board-options,
        body.theme-red .game-container {
            background-color: #660000;
        }

        /* Tema Roxo */
        body.theme-purple .board,
        body.theme-purple .board-options,
        body.theme-purple .game-container {
            background-color: #4b0082;
        }

        /* Tema Amarelo */
        body.theme-yellow .board,
        body.theme-yellow .board-options,
        body.theme-yellow .game-container {
            background-color: #ffcc00;
        }

        /* Tema Laranja */
        body.theme-orange .board,
        body.theme-orange .board-options,
        body.theme-orange .game-container {
            background-color: #FF8C00;
            /* Laranja escuro */
        }

        /* Tema Rosa */
        body.theme-pink .board,
        body.theme-pink .board-options,
        body.theme-pink .game-container {
            background-color: #FF1493;
            /* Rosa escuro */
        }

        /* Tema Cinza */
        body.theme-gray .board,
        body.theme-gray .board-options,
        body.theme-gray .game-container {
            background-color: #696969;
            /* Cinza escuro */
        }

        /* Tema Azul no modo escuro */
        body.dark-mode.theme-blue .board,
        body.dark-mode.theme-blue .board-options,
        body.dark-mode.theme-blue .game-container {
            background-color: #00122b;
            /* Azul escuro */
        }

        /* Tema Verde no modo escuro */
        body.dark-mode.theme-green .board,
        body.dark-mode.theme-green .board-options,
        body.dark-mode.theme-green .game-container {
            background-color: #002200;
            /* Verde escuro */
        }

        /* Tema Vermelho no modo escuro */
        body.dark-mode.theme-red .board,
        body.dark-mode.theme-red .board-options,
        body.dark-mode.theme-red .game-container {
            background-color: #330000;
            /* Vermelho escuro */
        }

        /* Tema Roxo no modo escuro */
        body.dark-mode.theme-purple .board,
        body.dark-mode.theme-purple .board-options,
        body.dark-mode.theme-purple .game-container {
            background-color: #2e004d;
            /* Roxo escuro */
        }

        /* Tema Amarelo no modo escuro */
        body.dark-mode.theme-yellow .board,
        body.dark-mode.theme-yellow .board-options,
        body.dark-mode.theme-yellow .game-container {
            background-color: #664d00;
            /* Amarelo escuro */
        }

        /* Tema Laranja no modo escuro */
        body.dark-mode.theme-orange .board,
        body.dark-mode.theme-orange .board-options,
        body.dark-mode.theme-orange .game-container {
            background-color: #CC7000;
            /* Laranja escuro no modo escuro */
        }

        /* Tema Rosa no modo escuro */
        body.dark-mode.theme-pink .board,
        body.dark-mode.theme-pink .board-options,
        body.dark-mode.theme-pink .game-container {
            background-color: #8B004B;
            /* Rosa escuro no modo escuro */
        }

        /* Tema Cinza no modo escuro */
        body.dark-mode.theme-gray .board,
        body.dark-mode.theme-gray .board-options,
        body.dark-mode.theme-gray .game-container {
            background-color: #2F2F2F;
            /* Cinza escuro no modo escuro */
        }

        .board-footer {
            display: flex;
            justify-content: space-between;
            /* Espa√ßa os elementos uniformemente */
            align-items: center;
            /* Centraliza os itens verticalmente */
            width: 100%;
            /* Ocupa toda a largura do cont√™iner */
            max-width: 480px;
            /* Limita a largura m√°xima */
            padding: 15px;
            background-color: inherit;
            /* Herda a cor do tema */
            border-radius: 0 0 10px 10px;
            /* Bordas arredondadas na parte inferior */
            box-shadow: none;
            /* Remove a sombra superior */
            box-sizing: border-box;
            margin-top: -5px;
            /* Reduz a margem superior para integrar melhor ao tabuleiro */
        }

        .toggle-mode-btn {
            background-color: rgba(255, 255, 255, 0.8);
            /* Fundo claro */
            color: #002147;
            /* Cor do √≠cone */
            font-size: 20px;
            /* Tamanho do √≠cone */
            padding: 10px;
            border: none;
            border-radius: 50%;
            /* Fundo circular */
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            /* Sombra para destaque */
        }

        .toggle-mode-btn:hover {
            background-color: rgba(255, 255, 255, 1);
            /* Fundo mais claro no hover */
            color: #004080;
            /* Cor mais vibrante no hover */
        }

        /* Estilos para telas menores (smartphones) */
        @media screen and (max-width: 600px) {
            .title {
                font-size: 1.5em;
            }

            .board {
                width: 90vw;
                height: 90vw;
                padding: 10px;
            }

            .tile {
                font-size: 1.2em;
            }

            .controls {
                flex-direction: column;
                /* Empilha os bot√µes verticalmente */
                align-items: center;
                /* Centraliza os bot√µes */
            }

            .btn {
                width: 80%;
                /* Garante que os bot√µes ocupem a largura total */
                margin-bottom: 10px;
                /* Adiciona espa√ßamento entre os bot√µes */
            }

            .status-container {
                flex-direction: column;
                /* Empilha as informa√ß√µes de status */
                gap: 10px;
                padding: 10px;
            }

            .info-message {
                padding: 10px;
                font-size: 0.9em;
            }

            .win-message {
                padding: 20px;
                font-size: 1em;
            }

            .scoreboard-container {
                width: 90%;
                margin-left: 0;
                /* Remove a margem esquerda */
            }

            .scoreboard-columns {
                grid-template-columns: 1fr;
                /* Uma coluna em telas pequenas */
            }
        }
    </style>
</head>

<body>
    <div class="developer-info">
        Desenvolvido por Bruno Fortunato
    </div>

    <div class="title">15 Puzzle Game</div>
    <div class="main-container">
        <div class="theme-controls">
            <div class="game-container">
                <div class="board-options">
                    <div class="dropdown">
                        <button class="icon-btn" onclick="toggleDropdown()"
                            title="Alternar tamanho do tabuleiro">üî≤</button>
                        <div class="dropdown-menu" id="dropdownMenu">
                            <button onclick="confirmChange(3)">3x3</button>
                            <button onclick="confirmChange(4)">4x4</button>
                            <button onclick="confirmChange(5)">5x5</button>
                        </div>
                    </div>
                    <button class="icon-btn play-pause-btn" onclick="togglePause()" title="Pausa o jogo">‚è∏Ô∏è</button>
                    <button class="icon-btn restart-btn" onclick="confirmRestart()" title="Reinicia o jogo">üîÑ</button>
                    <button class="icon-btn ranking-btn" onclick="showRankingOverlay()"
                        title="Exibe o ranking">üèÜ</button>
                    <button class="icon-btn upload-btn" onclick="document.getElementById('imageUpload').click()"
                        title="Carregar imagem">üñºÔ∏è</button>
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;"
                        onchange="handleImageUpload(event)">
                    <button class="icon-btn toggle-mode-btn" onclick="toggleTileMode()"
                        title="Alternar entre n√∫meros e imagens">üî¢</button>
                    <button class="icon-btn theme-mode-btn" onclick="toggleThemeMode()"
                        title="Alternar entre modo claro e escuro">‚òÄÔ∏è</button>
                </div>
                <div class="board" id="board"></div>
                <div class="board-footer">
                    <button class="icon-btn theme-arrow left-arrow" onclick="changeThemeByArrow(-1)"
                        title="Alterar tema anterior">
                        &#9664; </button>
                    <div class="status-container">
                        <div class="icon">
                            üèÅ <span id="moveCounter">0</span>
                        </div>
                        <div class="icon">
                            ‚è≥ <span id="timer">00:00:000</span>
                        </div>
                    </div>
                    <button class="icon-btn theme-arrow right-arrow" onclick="changeThemeByArrow(1)"
                        title="Alterar pr√≥ximo tema">
                        &#9654; </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let isPaused = false;
        let currentSize = 4; // Tamanho padr√£o do tabuleiro
        let moveCount = 0;
        let startTime;
        let timerInterval;
        let gameStarted = false;
        let tilesArray = [];
        let gameWon = false; // Adicionando a flag de vit√≥ria
        let isImageMode = false; // Vari√°vel para controlar o modo atual
        let currentImageUrl = ""; // Armazena a URL da imagem carregada

        const SCOREBOARD_KEY = 'puzzle15Scoreboard';

        function saveScore(size, moves, time) {
            try {
                let scoreboard = getScoreboard();
                const gameType = `${size}x${size}`; // Corrigido para usar template literals

                if (!scoreboard[gameType]) {
                    scoreboard[gameType] = { moves: [], times: [] };
                }

                scoreboard[gameType].moves.push(moves);
                scoreboard[gameType].moves.sort((a, b) => a - b);
                if (scoreboard[gameType].moves.length > 5) {
                    scoreboard[gameType].moves.pop();
                }

                const timeInMilliseconds = timeToMilliseconds(time);
                scoreboard[gameType].times.push(timeInMilliseconds);
                scoreboard[gameType].times.sort((a, b) => a - b);
                if (scoreboard[gameType].times.length > 5) {
                    scoreboard[gameType].times.pop();
                }

                localStorage.setItem(SCOREBOARD_KEY, JSON.stringify(scoreboard));
                updateScoreboardDisplay();
            } catch (error) {
                console.error("Erro ao salvar o placar:", error);
            }
        }

        function getScoreboard() {
            const storedScoreboard = localStorage.getItem(SCOREBOARD_KEY);
            return storedScoreboard ? JSON.parse(storedScoreboard) : {};
        }

        function updateScoreboardDisplay(container = document) {
            const scoreboardData = getScoreboard();
            [3, 4, 5].forEach(size => {
                const gameType = `${size}x${size}`;
                const movesContainer = container.querySelector(`#scoreboard-${size}x${size}-moves`);
                const timesContainer = container.querySelector(`#scoreboard-${size}x${size}-time`);

                if (movesContainer) {
                    movesContainer.innerHTML = "<strong>Melhores Movimentos:</strong><br>";
                    if (scoreboardData[gameType]?.moves) {
                        scoreboardData[gameType].moves.forEach(moves => {
                            movesContainer.innerHTML += `${moves} movimentos<br>`;
                        });
                    }
                }

                if (timesContainer) {
                    timesContainer.innerHTML = "<strong>Melhores Tempos:</strong><br>";
                    if (scoreboardData[gameType]?.times) {
                        scoreboardData[gameType].times.forEach(time => {
                            timesContainer.innerHTML += `${millisecondsToTime(time)}<br>`;
                        });
                    }
                }
            });
        }

        function timeToMilliseconds(timeString) {
            const [minutes, seconds, milliseconds] = timeString.split(':').map(Number);
            return (minutes * 60 + seconds) * 1000 + milliseconds;
        }

        function millisecondsToTime(totalMilliseconds) {
            const totalSeconds = Math.floor(totalMilliseconds / 1000);
            const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, "0");
            const seconds = String(totalSeconds % 60).padStart(2, "0");
            const milliseconds = String(totalMilliseconds % 1000).padStart(3, "0");
            return `${minutes}:${seconds}:${milliseconds}`;
        }

        function generateBoard(size) {
            const board = document.getElementById("board");
            if (!board) {
                console.error("Elemento 'board' n√£o encontrado.");
                return;
            }

            currentSize = size;
            moveCount = 0;
            gameStarted = false;
            isPaused = false;
            gameWon = false;

            document.getElementById("moveCounter").textContent = moveCount;
            resetTimer();

            board.innerHTML = "";
            board.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            board.style.gridTemplateRows = `repeat(${size}, 1fr)`;

            tilesArray = Array.from({ length: size * size - 1 }, (_, i) => String(i + 1));
            tilesArray.push("");

            renderBoard(); // Garante que os blocos sejam renderizados corretamente
            setTimeout(shuffleBoard, 100);
        }

        function getCorrectPosition(value) {
            if (value === "") {
                return currentSize * currentSize - 1;
            }
            return parseInt(value) - 1;
        }

        function renderBoard() {
            const board = document.getElementById("board");
            board.innerHTML = "";
            tilesArray.forEach((num, index) => {
                const tile = document.createElement("div");
                tile.classList.add("tile");
                tile.dataset.value = num;

                if (num === "") {
                    tile.classList.add("empty");
                    tile.style.backgroundImage = "none";
                    tile.textContent = ""; // Remove o texto do bloco vazio
                } else if (isImageMode && currentImageUrl) {
                    const correctRow = Math.floor((parseInt(num) - 1) / currentSize);
                    const correctCol = (parseInt(num) - 1) % currentSize;

                    tile.style.backgroundImage = `url(${currentImageUrl})`;
                    tile.style.backgroundSize = `${currentSize * 100}% ${currentSize * 100}%`;
                    tile.style.backgroundPosition = `${(correctCol * 100) / (currentSize - 1)}% ${(correctRow * 100) / (currentSize - 1)}%`;
                    tile.textContent = ""; // Remove os n√∫meros
                } else {
                    tile.style.backgroundImage = "none"; // Remove a imagem
                    tile.textContent = num; // Exibe os n√∫meros
                }

                // Adiciona o evento de clique ao bloco
                tile.addEventListener("click", handleTileClick);

                board.appendChild(tile);
            });
        }

        let themeMode = "light"; // Modo inicial: claro

        function toggleThemeMode() {
            const body = document.body;
            const themeButton = document.querySelector(".theme-mode-btn");

            if (body.classList.contains("dark-mode")) {
                body.classList.remove("dark-mode");
                themeButton.textContent = "‚òÄÔ∏è"; // √çcone para modo claro
                localStorage.setItem("themeMode", "light");
            } else {
                body.classList.add("dark-mode");
                themeButton.textContent = "üåô"; // √çcone para modo escuro
                localStorage.setItem("themeMode", "dark");
            }
        }

        // Carrega o modo salvo ao carregar a p√°gina
        document.addEventListener("DOMContentLoaded", () => {
            const savedThemeMode = localStorage.getItem("themeMode") || "light";
            const themeButton = document.querySelector(".theme-mode-btn");

            if (savedThemeMode === "dark") {
                document.body.classList.add("dark-mode");
                themeButton.textContent = "üåô";
            } else {
                themeButton.textContent = "‚òÄÔ∏è";
            }
        });

        const imageUploadElement = document.getElementById('imageUpload');
        let wasPaused = false; // Vari√°vel para rastrear se o jogo foi pausado pelo upload

        imageUploadElement.addEventListener('click', () => {
            console.log("Evento de clique no upload disparado.");
            if (gameStarted && !isPaused) {
                console.log("Jogo estava em andamento e n√£o pausado. Pausando o jogo.");
                clearInterval(timerInterval);
                accumulatedTime += Date.now() - startTime;
                wasPaused = true;
                console.log(`wasPaused agora √©: ${wasPaused}`);
            } else {
                console.log("Jogo j√° estava pausado ou n√£o iniciado.");
                wasPaused = true;
                console.log(`wasPaused agora √©: ${wasPaused}`);
            }
        });

        imageUploadElement.addEventListener('change', () => {
            console.log("Evento de change no upload disparado.");
            console.log(`imageUploadElement.files.length: ${imageUploadElement.files.length}`);
            console.log(`wasPaused: ${wasPaused}`);
            if (imageUploadElement.files.length === 0 && wasPaused) {
                console.log("Nenhum arquivo selecionado e jogo foi pausado por n√≥s. Retomando o jogo.");
                startTime = Date.now() - accumulatedTime;
                timerInterval = setInterval(updateTimer, 1000);
                isPaused = false;
                wasPaused = false;
                console.log(`isPaused agora √©: ${isPaused}`);
                console.log(`wasPaused agora √©: ${wasPaused}`);
            } else {
                console.log("Arquivo selecionado ou jogo n√£o foi pausado pelo upload. Chamando handleImageUpload.");
                handleImageUpload(event);
            }
        });

        function isSolvable(tilesArray, size) {
            if (tilesArray.length !== size * size) {
                console.error("O tamanho do array tilesArray n√£o corresponde ao tamanho do tabuleiro.");
                return false;
            }
            const tiles = tilesArray.filter(tile => tile !== ""); // Remove o espa√ßo vazio
            let inversions = 0;

            for (let i = 0; i < tiles.length; i++) {
                for (let j = i + 1; j < tiles.length; j++) {
                    if (parseInt(tiles[i]) > parseInt(tiles[j])) {
                        inversions++;
                    }
                }
            }

            if (size % 2 !== 0) {
                // Para tabuleiros de tamanho √≠mpar, o n√∫mero de invers√µes deve ser par
                return inversions % 2 === 0;
            } else {
                // Para tabuleiros de tamanho par, a posi√ß√£o da linha do espa√ßo vazio tamb√©m importa
                const emptyRow = Math.floor(tilesArray.indexOf("") / size);
                return (inversions % 2 === 0) === (emptyRow % 2 !== 0);
            }
        }

        function shuffleBoard() {
            let isValid = false;
            let attempts = 0;
            const maxAttempts = 100; // Limite de tentativas

            while (!isValid && attempts < maxAttempts) {
                attempts++;
                const numMoves = 1000;
                for (let i = 0; i < numMoves; i++) {
                    const emptyIndex = tilesArray.indexOf("");
                    const row = Math.floor(emptyIndex / currentSize);
                    const col = emptyIndex % currentSize;

                    const possibleMoves = [];
                    if (row > 0) possibleMoves.push(emptyIndex - currentSize);
                    if (row < currentSize - 1) possibleMoves.push(emptyIndex + currentSize);
                    if (col > 0) possibleMoves.push(emptyIndex - 1);
                    if (col < currentSize - 1) possibleMoves.push(emptyIndex + 1);

                    const randomIndex = Math.floor(Math.random() * possibleMoves.length);
                    const swapIndex = possibleMoves[randomIndex];

                    [tilesArray[emptyIndex], tilesArray[swapIndex]] = [tilesArray[swapIndex], tilesArray[emptyIndex]];
                }

                isValid = isSolvable(tilesArray, currentSize);
            }

            if (!isValid) {
                console.error("N√£o foi poss√≠vel gerar um tabuleiro solucion√°vel ap√≥s v√°rias tentativas.");
            }

            renderBoard();
        }

        function findEmptyPositionIndex() {
            return tilesArray.indexOf("");
        }

        function getTileIndex(tileElement) {
            return Array.from(tileElement.parentNode.children).indexOf(tileElement);
        }

        function getRowCol(index) {
            const row = Math.floor(index / currentSize);
            const col = index % currentSize;
            return { row, col };
        }

        function handleTileClick(event) {
            const clickedTile = event.target;
            if (!clickedTile.classList.contains('tile') || clickedTile.classList.contains('empty')) return;

            if (!isPaused && !gameWon) {
                const clickedIndex = getTileIndex(clickedTile);
                const emptyIndex = findEmptyPositionIndex();

                const clickedPos = getRowCol(clickedIndex);
                const emptyPos = getRowCol(emptyIndex);

                let moved = false;

                if (clickedPos.row === emptyPos.row || clickedPos.col === emptyPos.col) {
                    moved = moveLineOrColumn(clickedIndex, emptyIndex);
                }

                if (moved && !gameStarted) {
                    gameStarted = true;
                    startTimer();
                }

                if (moved) {
                    moveCount++;
                    document.getElementById("moveCounter").textContent = moveCount;
                    renderBoard();
                    checkWin();
                }
            }
        }

        function moveLineOrColumn(clickedIndex, emptyIndex) {
            const clickedPos = getRowCol(clickedIndex);
            const emptyPos = getRowCol(emptyIndex);
            const tempTilesArray = [...tilesArray];
            let moved = false;

            if (clickedPos.row === emptyPos.row) {
                const row = clickedPos.row;
                const start = Math.min(clickedIndex, emptyIndex);
                const end = Math.max(clickedIndex, emptyIndex);
                const tilesToMove = [];
                const direction = clickedIndex < emptyIndex ? 1 : -1;

                let currentIndex = clickedIndex;
                while (currentIndex !== emptyIndex) {
                    tilesToMove.push(tempTilesArray[currentIndex]);
                    currentIndex += direction;
                }

                currentIndex = emptyIndex;
                while (currentIndex !== clickedIndex) {
                    tempTilesArray[currentIndex] = tilesToMove.pop();
                    currentIndex -= direction;
                }
                tempTilesArray[clickedIndex] = "";
                moved = true;

            } else if (clickedPos.col === emptyPos.col) {
                const col = clickedPos.col;
                const start = Math.min(clickedIndex, emptyIndex);
                const end = Math.max(clickedIndex, emptyIndex);
                const tilesToMove = [];
                const direction = clickedIndex < emptyIndex ? currentSize : -currentSize;

                let currentIndex = clickedIndex;
                while (currentIndex !== emptyIndex) {
                    tilesToMove.push(tempTilesArray[currentIndex]);
                    currentIndex += direction;
                }

                currentIndex = emptyIndex;
                while (currentIndex !== clickedIndex) {
                    tempTilesArray[currentIndex] = tilesToMove.pop();
                    currentIndex -= direction;
                }
                tempTilesArray[clickedIndex] = "";
                moved = true;
            }

            if (moved) {
                tilesArray = tempTilesArray;
                return true;
            }
            return false;
        }

        function togglePause() {
            if (!gameStarted) {
                console.warn("O jogo ainda n√£o come√ßou.");
                return;
            }
            const board = document.getElementById("board");
            const pauseBtn = document.querySelector(".play-pause-btn"); // Seleciona o bot√£o de play/pausa
            isPaused = !isPaused;
            board.classList.toggle("paused", isPaused);

            // Alterna o √≠cone e o t√≠tulo do bot√£o
            if (isPaused) {
                pauseBtn.textContent = "‚ñ∂Ô∏è"; // √çcone de continuar
                pauseBtn.title = "Continuar o jogo"; // Atualiza o t√≠tulo
                clearInterval(timerInterval);
                accumulatedTime += Date.now() - startTime; // Atualiza o tempo acumulado
            } else {
                pauseBtn.textContent = "‚è∏Ô∏è"; // √çcone de pausa
                pauseBtn.title = "Pausar o jogo"; // Atualiza o t√≠tulo
                if (gameStarted) {
                    startTimer();
                }
            }
        }

        function confirmChange(size) {
            if (!gameStarted) {
                generateBoard(size);
            } else {
                showConfirmationOverlay(
                    "Tem certeza que deseja mudar para o tabuleiro " + size + "x" + size + "? Seu progresso atual ser√° perdido.",
                    () => { // Fun√ß√£o a ser executada se o usu√°rio clicar em "Sim"
                        generateBoard(size);
                    }
                );
            }
        }

        function confirmRestart() {
            if (!gameStarted) {
                generateBoard(currentSize);
            } else {
                showConfirmationOverlay(
                    "Tem certeza que deseja reiniciar o jogo? Seu progresso atual ser√° perdido.",
                    () => { // Fun√ß√£o a ser executada se o usu√°rio clicar em "Sim"
                        generateBoard(currentSize);
                    }
                );
            }
        }

        function showConfirmationOverlay(message, onConfirm) {
            let wasTimerRunning = gameStarted && !isPaused;

            clearInterval(timerInterval);
            if (gameStarted && !isPaused) {
                accumulatedTime += Date.now() - startTime; // Atualiza o tempo acumulado
            }

            const confirmationOverlay = document.createElement('div');
            confirmationOverlay.classList.add('win-overlay');

            const confirmationMessage = document.createElement('div');
            confirmationMessage.classList.add('win-message');

            const title = document.createElement('h2');
            title.textContent = "Confirma√ß√£o";

            const text = document.createElement('p');
            text.textContent = message;

            const confirmButton = document.createElement('button');
            confirmButton.classList.add('play-again-btn');
            confirmButton.textContent = "Sim";
            confirmButton.onclick = () => {
                onConfirm();
                confirmationOverlay.remove();
                if (gameStarted) {
                    resetTimer();
                }
            };

            const cancelButton = document.createElement('button');
            cancelButton.classList.add('play-again-btn');
            cancelButton.textContent = "N√£o";
            cancelButton.onclick = () => {
                confirmationOverlay.remove();
                if (wasTimerRunning) {
                    startTimer();
                }
            };

            confirmationMessage.appendChild(title);
            confirmationMessage.appendChild(text);
            confirmationMessage.appendChild(confirmButton);
            confirmationMessage.appendChild(cancelButton);
            confirmationOverlay.appendChild(confirmationMessage);
            document.body.appendChild(confirmationOverlay);

            setTimeout(() => {
                confirmationOverlay.classList.add('active');
            }, 10);
        }

        let accumulatedTime = 0;

        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            startTime = Date.now();
            clearInterval(timerInterval);

            timerInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const totalElapsed = elapsed + accumulatedTime; // Adiciona o tempo acumulado
                const minutes = String(Math.floor(totalElapsed / 60000)).padStart(2, "0");
                const seconds = String(Math.floor((totalElapsed % 60000) / 1000)).padStart(2, "0");
                const milliseconds = String(totalElapsed % 1000).padStart(3, "0");

                document.getElementById("timer").textContent = `${minutes}:${seconds}:${milliseconds}`;
            }, 10);
        }

        function resetTimer() {
            clearInterval(timerInterval);
            document.getElementById("timer").textContent = "00:00:000";
        }

        function checkWin() {
            if (gameWon) return; // Evita reexecu√ß√£o desnecess√°ria

            const solvedBoard = [];
            for (let i = 1; i < currentSize * currentSize; i++) {
                solvedBoard.push(String(i));
            }
            solvedBoard.push("");

            let hasWon = true;
            for (let i = 0; i < tilesArray.length; i++) {
                if (tilesArray[i] !== solvedBoard[i]) {
                    hasWon = false;
                    break;
                }
            }

            if (hasWon) {
                gameWon = true; // Define a flag de vit√≥ria
                clearInterval(timerInterval);
                const finalTime = document.getElementById("timer").textContent;
                saveScore(currentSize, moveCount, finalTime);
                updateScoreboardDisplay();

                mostrarTelaDeVitoria(finalTime);
            }
        }

        function mostrarTelaDeVitoria(finalTime) {
            const winOverlay = document.createElement('div');
            winOverlay.classList.add('win-overlay');

            const winMessage = document.createElement('div');
            winMessage.classList.add('win-message');

            winMessage.innerHTML = `
            <h2>Voc√™ Venceu!</h2>
            <p>Movimentos: ${moveCount}</p>
            <p>Tempo: ${finalTime}</p>
            <button class="play-again-btn" onclick="reiniciarJogo()">Jogar Novamente</button>
        `;

            winOverlay.appendChild(winMessage);
            document.body.appendChild(winOverlay);

            setTimeout(() => {
                winOverlay.classList.add('active');
            }, 10);

            document.getElementById("board").classList.add('game-over');
        }

        function reiniciarJogo() {
            const existingOverlay = document.querySelector('.win-overlay');
            if (existingOverlay) {
                existingOverlay.remove();
            }
            generateBoard(currentSize);
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) {
                // Se o usu√°rio cancelar o upload, retome o cron√¥metro
                if (gameStarted && isPaused) {
                    isPaused = false; // Atualiza o estado de pausa
                    startTimer(); // Retoma o cron√¥metro
                }
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                const imageUrl = e.target.result;
                applyImageToTiles(imageUrl);

                // Retome o cron√¥metro ap√≥s o upload
                if (gameStarted && isPaused) {
                    isPaused = false; // Atualiza o estado de pausa
                    startTimer(); // Retoma o cron√¥metro
                }
            };
            reader.readAsDataURL(file);
        }

        // Pausa o cron√¥metro ao abrir o seletor de arquivos
        document.getElementById('imageUpload').addEventListener('click', () => {
            if (gameStarted && !isPaused) {
                isPaused = true; // Pausa o jogo
                clearInterval(timerInterval); // Pausa o cron√¥metro
                accumulatedTime += Date.now() - startTime; // Atualiza o tempo acumulado
            }
        });

        // Retoma o cron√¥metro se o upload for cancelado ou o seletor de arquivos perder o foco
        document.getElementById('imageUpload').addEventListener('focusout', () => {
            if (gameStarted && isPaused) {
                isPaused = false; // Atualiza o estado de pausa
                startTimer(); // Retoma o cron√¥metro
            }
        });

        // Retoma o cron√¥metro se o upload for cancelado explicitamente
        document.getElementById('imageUpload').addEventListener('change', (event) => {
            if (!event.target.files[0] && gameStarted && isPaused) {
                isPaused = false; // Atualiza o estado de pausa
                startTimer(); // Retoma o cron√¥metro
            }
        });

        function applyImageToTiles(imageUrl) {
            currentImageUrl = imageUrl; // Salva a URL da imagem atual
            isImageMode = true; // Ativa o modo de imagem
            renderBoard(); // Re-renderiza o tabuleiro com a imagem
        }

        function showRankingOverlay() {
            const wasTimerRunning = gameStarted && !isPaused; // Verifica se o cron√¥metro estava rodando

            if (wasTimerRunning) {
                clearInterval(timerInterval); // Pausa o cron√¥metro
                accumulatedTime += Date.now() - startTime; // Atualiza o tempo acumulado
            }

            const rankingOverlay = document.createElement('div');
            rankingOverlay.classList.add('win-overlay');

            const rankingMessage = document.createElement('div');
            rankingMessage.classList.add('win-message');

            const title = document.createElement('h2');
            title.textContent = "Ranking";

            const closeButton = document.createElement('button');
            closeButton.classList.add('play-again-btn');
            closeButton.textContent = "Fechar";
            closeButton.onclick = () => {
                rankingOverlay.remove();
                if (wasTimerRunning) {
                    startTimer(); // Retoma o cron√¥metro
                }
            };

            const scoreboardContainer = document.createElement('div');
            scoreboardContainer.classList.add('scoreboard-columns');
            scoreboardContainer.innerHTML = `
                <div class="scoreboard-column">
                    <h3>3x3</h3>
                    <div id="scoreboard-3x3-moves"></div>
                    <div id="scoreboard-3x3-time"></div>
                </div>
                <div class="scoreboard-column">
                    <h3>4x4</h3>
                    <div id="scoreboard-4x4-moves"></div>
                    <div id="scoreboard-4x4-time"></div>
                </div>
                <div class="scoreboard-column">
                    <h3>5x5</h3>
                    <div id="scoreboard-5x5-moves"></div>
                    <div id="scoreboard-5x5-time"></div>
                </div>
            `;

            rankingMessage.appendChild(title);
            rankingMessage.appendChild(scoreboardContainer);
            rankingMessage.appendChild(closeButton);
            rankingOverlay.appendChild(rankingMessage);
            document.body.appendChild(rankingOverlay);

            setTimeout(() => {
                rankingOverlay.classList.add('active');
            }, 10);

            // Atualiza os dados do placar no overlay
            updateScoreboardDisplay(rankingOverlay);
        }

        const themes = [
            'theme-blue',   // Azul
            'theme-yellow', // Amarelo
            'theme-gray',   // Cinza
            'theme-orange', // Laranja
            'theme-pink',   // Rosa
            'theme-purple', // Roxo
            'theme-green',  // Verde
            'theme-red'     // Vermelho
        ];

        function changeTheme(theme) {
            const body = document.body;
            const gameContainer = document.querySelector('.game-container'); // Seleciona o container do jogo
            const boardOptions = document.querySelector('.board-options'); // Seleciona a barra de op√ß√µes

            // Remove todas as classes de tema do body, do container do jogo e da barra de op√ß√µes
            themes.forEach(t => {
                body.classList.remove(t);
                if (gameContainer) gameContainer.classList.remove(t);
                if (boardOptions) boardOptions.classList.remove(t);
            });

            // Adiciona a classe do tema selecionado ao body, ao container do jogo e √† barra de op√ß√µes
            body.classList.add(theme);
            if (gameContainer) gameContainer.classList.add(theme);
            if (boardOptions) boardOptions.classList.add(theme);

            // Salva o tema no localStorage para manter a prefer√™ncia do usu√°rio
            localStorage.setItem('selectedTheme', theme);

            // Atualiza o seletor de temas
            const themeSelector = document.getElementById('themeSelector');
            if (themeSelector) {
                themeSelector.value = theme;
            }
        }

        function changeThemeByArrow(direction) {
            const body = document.body;
            const currentTheme = themes.find(theme => body.classList.contains(theme));
            let currentIndex = themes.indexOf(currentTheme);

            // Verifica se o tema atual foi encontrado
            if (currentIndex === -1) {
                currentIndex = 0; // Define o √≠ndice como 0 se nenhum tema for encontrado
            }

            // Calcula o pr√≥ximo √≠ndice
            currentIndex = (currentIndex + direction + themes.length) % themes.length;

            // Aplica o pr√≥ximo tema
            const newTheme = themes[currentIndex];
            changeTheme(newTheme);
        }

        // Carrega o tema salvo ao carregar a p√°gina
        document.addEventListener("DOMContentLoaded", () => {
            const savedTheme = localStorage.getItem('selectedTheme') || 'theme-blue';
            changeTheme(savedTheme);
            document.getElementById('themeSelector').value = savedTheme;
        });

        document.addEventListener("DOMContentLoaded", () => {
            // Define o tema padr√£o como azul
            const defaultTheme = 'theme-blue';
            changeTheme(defaultTheme); // Aplica o tema padr√£o

            // Gera o tabuleiro inicial e atualiza o placar
            generateBoard(4);
            updateScoreboardDisplay();
        });

        document.getElementById('imageUpload').addEventListener('click', () => {
            if (gameStarted && !isPaused) {
                clearInterval(timerInterval); // Pausa o cron√¥metro
                accumulatedTime += Date.now() - startTime; // Atualiza o tempo acumulado
            }
        });

        function toggleDropdown() {
            const dropdownMenu = document.getElementById("dropdownMenu");
            dropdownMenu.style.display = dropdownMenu.style.display === "block" ? "none" : "block";
        }

        // Fecha o menu suspenso ao clicar fora dele
        document.addEventListener("click", (event) => {
            const dropdown = document.querySelector(".dropdown");
            if (!dropdown.contains(event.target)) {
                const dropdownMenu = document.getElementById("dropdownMenu");
                dropdownMenu.style.display = "none";
            }
        });

        function toggleTileMode() {
            isImageMode = !isImageMode; // Alterna entre n√∫meros e imagens
            renderBoard(); // Re-renderiza o tabuleiro com base no modo atual
        }
    </script>
</body>

</html>